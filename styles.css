:root{
  --bg:#0d0f12;
  --panel:#151922;
  --muted:#8b94a7;
  --text:#e9edf4;
  --accent:#48d06d;
  --accent-ghost:rgba(72,208,109,0.15);
  --danger:#ff6b6b;
  --radius:14px;
  --gap:12px;
  --shadow:0 8px 24px rgba(0,0,0,.35);
  --header-sticky-offset:88px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  --font: system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:var(--font);
  color:var(--text);
  background:linear-gradient(180deg,#0c0f15 0%,#0b0e13 100%);
  display:flex;
  flex-direction:column;
  min-height:100%;
  padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

.muted{color:var(--muted);}

.app-header,
main,
.app-footer{
  width:min(960px, 100%);
  margin:0 auto;
}

.app-header{
  position:sticky; top:0; z-index:3;
  background:rgba(13,15,18,.8);
  backdrop-filter: blur(8px);
  border-bottom:1px solid #1f2530;
  padding:clamp(12px, 4vw, 20px);
}
.app-header h1{margin:0 0 6px 0; font-size:1.25rem; letter-spacing: .5px}

.day-controls{
  display:flex; gap:8px; align-items:center; justify-content:center;
  margin-bottom:10px;
  flex-wrap:wrap;
}
.day-controls input[type="date"]{
  background:var(--panel); color:var(--text);
  border:1px solid #2a3240; border-radius:10px; padding:8px 10px; min-width: 180px;
  flex:1 1 160px;
}
.day-controls button{
  background:var(--panel); color:var(--text);
  border:1px solid #2a3240; border-radius:10px; padding:8px 10px;
  flex:0 0 auto;
}

.tabs{display:flex; gap:8px; flex-wrap:wrap}
.tab{
  flex:1; padding:10px; border-radius:999px; border:1px solid #2a3240;
  background:var(--panel); color:var(--muted); font-weight:600;
}
.tab.active{color:var(--text); border-color:var(--accent); box-shadow:inset 0 0 0 1px var(--accent-ghost)}

main{flex:1 1 auto; padding:clamp(14px, 5vw, 28px)}
.tab-panel.hidden{display:none}

.table-scroll{overflow:auto; max-width:100%;}
.data-table{width:100%; border-collapse:collapse; font-size:.9rem;}
.data-table thead{background:#0f131a;}
.data-table th,.data-table td{padding:10px 12px; text-align:left; border-bottom:1px solid #1f2532; white-space:nowrap;}
.data-table tbody tr:nth-child(odd){background:rgba(15,19,26,0.6);}
.data-table td[data-align="right"]{text-align:right;}
.badge{display:inline-flex; align-items:center; gap:4px; background:#0b0f16; padding:2px 8px; border-radius:10px; border:1px solid #1e2633;}

.hidden{display:none !important;}

.sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;}

.alert{background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.12); border-radius:12px; padding:12px 16px; margin:12px 0; font-size:.9rem;}

.seguimiento-header{
  display:flex;
  justify-content:flex-end;
  margin-bottom:16px;
  position:sticky;
  top:calc(var(--header-sticky-offset) + clamp(8px, 3vw, 18px));
  z-index:2;
  padding:12px 0;
  background:rgba(13,15,18,0.92);
  backdrop-filter:blur(8px);
}
.seguimiento-header button{flex:0 0 auto;}

.seguimiento-layout{display:flex; gap:16px; align-items:stretch;}
.seguimiento-panel{flex:1; background:rgba(15,19,26,0.65); border:1px solid #252c3a; border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); min-height:360px;}
.seguimiento-panel .empty-hint{margin:0; text-align:center; color:var(--muted); font-size:.9rem;}

.history-list{list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px; max-height:520px; overflow:auto;}
.history-item-button{width:100%; text-align:left; background:transparent; border:1px solid #2a3240; color:var(--text); border-radius:12px; padding:10px 14px; font-weight:600; display:block;}
.history-item-button.active{border-color:var(--accent); box-shadow:inset 0 0 0 1px var(--accent-ghost);}
.history-item{display:flex; flex-direction:column; gap:6px;}
.history-item-chips{display:flex; flex-wrap:wrap; gap:6px;}
.history-chip{background:#0f131a; color:var(--muted); border:1px solid #2a3240; border-radius:999px; padding:4px 10px; font-size:.75rem;}
.history-chip.active{border-color:var(--accent); color:var(--accent);}

.history-detail{display:flex; flex-direction:column; gap:18px;}
.history-detail-header{display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:12px;}
.history-detail-header h2{margin:0; font-size:1.2rem;}
.type-selector{display:flex; gap:8px; flex-wrap:wrap;}
.type-selector-btn{background:transparent; border:1px solid #2a3240; color:var(--text); border-radius:999px; padding:6px 14px; font-weight:600;}
.type-selector-btn.active{border-color:var(--accent); color:var(--accent); box-shadow:inset 0 0 0 1px var(--accent-ghost);}

.history-controls{display:flex; align-items:center; gap:10px; flex-wrap:wrap; font-size:.9rem;}
.history-controls select{background:#0f131a; color:var(--text); border:1px solid #2a3240; border-radius:10px; padding:6px 10px;}

.history-summary{display:flex; flex-direction:column; gap:12px;}
.summary-badge{display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; background:#0f131a; border:1px solid #2a3240; width:max-content;}
.summary-badge.up{border-color:#48d06d; color:#48d06d;}
.summary-badge.down{border-color:#ff6b6b; color:#ff6b6b;}
.summary-badge.same{color:var(--muted);}
.summary-grid{display:grid; gap:12px; grid-template-columns:repeat(auto-fit, minmax(180px,1fr));}
.summary-grid dt{font-size:.85rem; color:var(--muted); margin-bottom:4px;}
.summary-grid dd{margin:0; font-weight:600;}

.history-chart-wrapper{border:1px solid #252c3a; border-radius:14px; background:#0f131a; padding:12px;}

.data-table .actions-header{text-align:right;}
.data-table td:last-child, .data-table th:last-child{text-align:right;}

.link-button{background:none; border:none; color:#93c5fd; padding:0 6px; font-size:.85rem; cursor:pointer;}
.link-button.danger{color:#fca5a5;}

.toast{position:fixed; left:50%; bottom:20px; transform:translateX(-50%); background:#0f131a; color:var(--text); padding:10px 18px; border-radius:999px; border:1px solid #2a3240; box-shadow:0 12px 32px rgba(0,0,0,.4); opacity:0; pointer-events:none; transition:opacity .3s ease, transform .3s ease; z-index:20;}
.toast.visible{opacity:1; transform:translateX(-50%) translateY(-6px);}

.modal-overlay{position:fixed; inset:0; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; padding:16px; z-index:30;}
.modal{background:#0f131a; border:1px solid #2a3240; border-radius:16px; padding:20px; max-width:340px; width:100%; box-shadow:var(--shadow); display:flex; flex-direction:column; gap:16px;}
.modal h3{margin:0;}
.modal-form{display:flex; flex-direction:column; gap:12px;}
.modal-field{display:flex; flex-direction:column; gap:6px; font-size:.9rem;}
.modal-field input, .modal-field textarea, .modal-row select{background:#131924; border:1px solid #2a3240; color:var(--text); border-radius:10px; padding:8px 10px; font-size:1rem;}
.modal-row{display:flex; flex-direction:column; gap:6px;}
.modal-actions{display:flex; justify-content:flex-end; gap:10px;}

@media (max-width: 880px){
  :root{
    --header-sticky-offset:72px;
  }
  .seguimiento-layout{flex-direction:column;}
  .seguimiento-panel{min-height:auto;}
}

.card{
  background:var(--panel); border:1px solid #252c3a; border-radius:var(--radius);
  padding:clamp(12px, 4vw, 20px); box-shadow:var(--shadow);
}

.grid{display:grid; gap:var(--gap)}
.field{display:flex; flex-direction:column; gap:6px}
.field.inline{display:flex; flex-direction:column; width:100%}
.field span{font-size:.85rem; color:var(--muted)}
.field input, .field select, .field textarea{
  background:#0f131a; color:var(--text); border:1px solid #2a3240; border-radius:10px; padding:10px;
}

.form-stepper{display:flex; gap:8px; margin-bottom:16px; flex-wrap:wrap;}
.form-step-btn{flex:1 1 auto; padding:10px 14px; border-radius:999px; border:1px solid #2a3240; background:#0f131a; color:var(--muted); font-weight:600; text-transform:uppercase; font-size:.78rem; letter-spacing:.4px;}
.form-step-btn.active{color:var(--text); border-color:var(--accent); box-shadow:inset 0 0 0 1px var(--accent-ghost);}
.form-steps{display:flex; flex-direction:column; gap:20px;}
.form-step{display:none;}
.form-step.active{display:block;}
.chip{background:#0f131a; border:1px solid #2a3240; border-radius:999px; padding:6px 12px; color:var(--text); font-size:.85rem;}
.chip:hover{border-color:var(--accent); color:var(--accent);}
.form-hint{margin-top:12px; padding:12px; border:1px solid #252c3a; border-radius:12px; background:rgba(15,19,26,0.65); color:var(--muted); font-size:.88rem;}
.step-actions{display:flex; gap:8px; justify-content:flex-end; align-items:center; flex-wrap:wrap; margin-top:12px;}

.fieldset{
  border:1px solid #2a3240; border-radius:12px; padding:10px; background:#0f131a;
}
.fieldset .legend{display:block; color:var(--muted); margin-bottom:6px; font-size:.9rem}
.row{display:flex; align-items:center; gap:8px}
.row.indent{margin-left:28px; margin-top:6px}
.row.inline{gap:12px}

.actions{display:flex; gap:8px; margin-top:10px}
button{
  cursor:pointer;
  background:var(--accent); color:#08150c; border:none; border-radius:12px; padding:10px 14px; font-weight:700;
  box-shadow:0 4px 12px rgba(72,208,109,.25);
}
button.ghost{
  background:transparent; color:var(--text);
  border:1px solid #2a3240; box-shadow:none;
}
button.primary{background:var(--accent)}
button.danger{background:var(--danger); color:#1d0000}
button.success{background:#2f855a; color:#f0fff4; border:1px solid #2f855a; box-shadow:0 4px 12px rgba(47,133,90,.25)}
button.success:hover{background:#276749}
button.success:focus-visible{outline:2px solid #68d391; outline-offset:2px}
button.small{padding:6px 10px; font-size:.85rem; border-radius:10px}
button.link{background:transparent; color:var(--accent); border:none; padding:0}

.app-footer{padding:16px; text-align:center; color:var(--muted)}

.day-summary{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; flex-wrap:wrap}
#dayTitle{margin:0; font-size:1.05rem}
.copy-day{display:flex; align-items:center; gap:8px; flex-wrap:wrap}
.copy-box{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
.copy-box input[type="date"]{flex:1 1 160px; min-width:0}
.copy-box.hidden{display:none}

.today-panel{margin:16px 0 20px; display:flex; flex-direction:column; gap:20px;}
.today-overview{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(180px,1fr));}
.insight-card{background:rgba(12,16,23,0.65); border:1px solid #252c3a; border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:6px; box-shadow:inset 0 1px 0 rgba(255,255,255,0.03);}
.insight-card header{font-size:.85rem; color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.4px;}
.insight-card p{margin:0;}
.insight-card strong{font-size:1.35rem;}
.insight-card small{color:var(--muted);}
.today-cta{display:flex; flex-direction:column; gap:10px;}
.rpe-header{display:flex; align-items:center; justify-content:space-between; gap:8px;}
.rpe-header h3{margin:0; font-size:1rem;}
.rpe-control{display:flex; align-items:center; gap:12px;}
.rpe-control input[type="range"]{flex:1 1 auto; accent-color:var(--accent);}
.rpe-control output{font-weight:700; min-width:28px; text-align:center;}
.today-badges{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(160px,1fr));}
.today-badge{background:#0f131a; border:1px solid #252c3a; border-radius:12px; padding:10px 14px; display:flex; flex-direction:column; gap:4px;}
.today-badge strong{font-size:1.1rem;}
.today-habits{display:flex; flex-direction:column; gap:8px;}
.today-habits h3{margin:0; font-size:1rem;}
.habit-list{display:flex; flex-wrap:wrap; gap:8px;}
.habit-chip{display:flex; align-items:center; gap:6px; background:#0f131a; border:1px solid #2a3240; border-radius:999px; padding:6px 12px; font-size:.85rem; transition:border-color .2s ease, color .2s ease;}
.habit-chip input{accent-color:var(--accent);}
.habit-chip:hover{border-color:var(--accent); color:var(--accent);}
.field.compact span{font-size:.75rem;}
.field.compact input,.field.compact select{padding:8px;}
.history-trends{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); margin:16px 0;}
.trend-card{background:#0f131a; border:1px solid #252c3a; border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:6px; box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);}
.trend-card h4{margin:0; font-size:.85rem; color:var(--muted); text-transform:uppercase; letter-spacing:.4px;}
.trend-card strong{font-size:1.1rem;}
.trend-card.trend-pr{border-color:#f97316; box-shadow:0 0 0 1px rgba(249,115,22,0.25);}
.trend-card.trend-last{border-color:rgba(72,208,109,0.4);}
.trend-badge{background:rgba(249,115,22,0.2); color:#ffedd5; font-size:.75rem; border-radius:999px; padding:2px 8px; width:max-content;}

.exercise-list{list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:16px; position:relative}
.exercise{
  position:relative;
  padding:clamp(20px, 6vw, 28px) clamp(12px, 4vw, 20px) clamp(12px, 4vw, 20px);
  border:1px solid #2a3240;
  border-radius:14px;
  background:linear-gradient(180deg,#121722 0,#0f131d 100%);
}
.exercise.completed{border-color:#2f855a; box-shadow:0 0 0 1px rgba(47,133,90,.4)}
.exercise.completed .meta span{border-color:#234d36}
.exercise .title{display:flex; align-items:center; justify-content:space-between; gap:12px}
.exercise .title-main{display:flex; align-items:center; gap:10px; flex:1; min-width:0}
.exercise .title-main h3{margin:0; flex:1; min-width:0}
.exercise .meta{color:var(--muted); font-size:.9rem; margin:6px 0; display:flex; flex-wrap:wrap; gap:6px}
.exercise .meta span{background:#0b0f16; padding:2px 8px; border-radius:8px; border:1px solid #1e2633}

.recovery-strip{display:flex; flex-wrap:wrap; gap:16px; align-items:center; background:rgba(15,19,26,0.55); border:1px solid #252c3a; border-radius:12px; padding:10px 12px; margin:8px 0;}
.recovery-effort{display:flex; align-items:center; gap:10px; flex-wrap:wrap;}
.recovery-value{font-weight:700;}
.recovery-value.active{color:var(--accent);}

button.micro{padding:4px 8px; font-size:.75rem; border-radius:8px;}
button.ghost.micro{background:transparent; border:1px solid #2a3240; color:var(--muted); box-shadow:none;}

.exercise .controls{display:flex; gap:6px; flex-wrap:wrap}
.exercise .note-toggle{display:inline-flex; align-items:center; justify-content:center; min-width:38px;}
.exercise .note-toggle.has-note{border-color:var(--accent); color:var(--accent); box-shadow:inset 0 0 0 1px var(--accent-ghost); background:rgba(72,208,109,0.15);}
.exercise .note-box{margin-top:10px; border-top:1px dashed #2a3240; padding-top:10px; display:flex; flex-direction:column; gap:10px;}
.exercise .note-box textarea{min-height:80px; resize:vertical; font-family:inherit; font-size:1rem;}
.exercise .note-actions{display:flex; justify-content:flex-end; gap:8px;}
.exercise .edit-box{margin-top:10px; border-top:1px dashed #2a3240; padding-top:10px}
.exercise .sets-grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(80px,1fr)); gap:8px}
.exercise .sets-grid input{width:100%}
.drag-handle{border:1px solid #2a3240; background:#0b0f16; color:#d7e2ff; border-radius:10px; padding:6px; display:flex; align-items:center; justify-content:center; cursor:grab; touch-action:none; min-width:36px; min-height:36px; font-size:1.2rem; line-height:1; box-shadow:inset 0 1px 0 rgba(255,255,255,.05)}
.drag-handle span{pointer-events:none}
.drag-handle:focus-visible{outline:2px solid #6c8ff2; outline-offset:2px}
.exercise.dragging{opacity:.95; box-shadow:0 16px 32px rgba(0,0,0,.45); cursor:grabbing}
.exercise.dragging .drag-handle{cursor:grabbing}
.exercise-placeholder{border:2px dashed #2a3240; border-radius:14px; background:rgba(15,19,29,.6)}
body.is-dragging{user-select:none}

.category-tag{
  position:absolute;
  top:0;
  left:24px;
  transform:translateY(-50%);
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 14px;
  border-radius:999px;
  font-weight:600;
  letter-spacing:.3px;
  text-transform:uppercase;
  font-size:.7rem;
  border:1px solid rgba(255,255,255,0.1);
  background:linear-gradient(135deg, rgba(21,27,40,0.95) 0%, rgba(9,12,18,0.95) 100%);
  box-shadow:0 8px 18px rgba(0,0,0,.35);
  white-space:nowrap;
}
.category-tag::before{
  content:"";
  width:8px;
  height:8px;
  border-radius:50%;
  background:currentColor;
  box-shadow:0 0 0 2px rgba(255,255,255,0.08);
}
.category-tag-calistenia{color:#48d06d; border-color:rgba(72,208,109,0.35);}
.category-tag-musculacion{color:#63b3ed; border-color:rgba(99,179,237,0.35);}
.category-tag-cardio{color:#f6ad55; border-color:rgba(246,173,85,0.35);}
.category-tag-skill{color:#ed64a6; border-color:rgba(237,100,166,0.35);}

.empty-hint{
  opacity:.8; text-align:center; color:var(--muted);
  border:1px dashed #2a3240; border-radius:12px; padding:16px; margin-top:12px;
}

.mini-cal{
  position:fixed; right:10px; bottom:10px; z-index:5;
  background:var(--panel); border:1px solid #2a3240; border-radius:16px; box-shadow:var(--shadow);
  width: 290px; max-width: 90vw; padding:10px;
}
.mini-cal-header{display:flex; align-items:center; justify-content:space-between; margin-bottom:6px}
.mini-cal-header #mcLabel{font-weight:700}
.mini-cal-grid{
  display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; align-items:center;
}
.mini-cal-grid .dow{
  text-align:center; color:var(--muted); font-size:.75rem;
}
.mini-cal-grid button.day{
  aspect-ratio:1/1;
  background:#0f131a; color:var(--text); border:1px solid #2a3240; border-radius:10px; padding:0;
  font-weight:600;
}
.mini-cal-grid button.day.today{outline:2px solid var(--accent)}
.mini-cal-grid button.day.has{box-shadow: inset 0 0 0 2px var(--accent-ghost)}
.mini-cal-grid button.day.selected{background:var(--accent); color:#062410}

@media (max-width: 640px){
  .mini-cal{display:none}
  .app-header,
  main,
  .app-footer{width:100%;}
  .tabs{width:100%;}
  .tab{flex:1 1 calc(50% - 4px); text-align:center}
  .day-summary{align-items:flex-start;}
  .day-summary h2{font-size:1rem}
  .copy-day{width:100%; flex-wrap:wrap; justify-content:flex-start}
  .copy-day button{flex:1 1 120px}
  .exercise .title{flex-direction:column; align-items:flex-start}
  .exercise .title-main{width:100%}
  .exercise .controls{width:100%}
  .fieldset{padding:12px}
  .row{flex-wrap:wrap; align-items:flex-start}
}

@media (min-width: 800px){
  main{max-width:900px; margin:0 auto}
}
