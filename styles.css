:root {
  --bg:#0a0a0a;
  --panel:#151515;
  --elev:#1e1e1e;
  --border:#2a2a2a;
  --text:#f0f0f0;
  --muted:#b5b5b5;
  --accent:#4cc9f0;
  --accent-2:#f59e0b;
  --error:#ef4444;
  --success:#22c55e;
  --radius-sm:10px;
  --radius-md:14px;
  --radius-lg:18px;
  --shadow-soft:0 8px 28px rgba(0,0,0,0.35);
  --shadow-strong:0 12px 32px rgba(0,0,0,0.55);
  --shadow-pressed:0 4px 16px rgba(0,0,0,0.65);
  --font-base:16px;
  --line-height:1.5;
  --spacing-xs:8px;
  --spacing-sm:12px;
  --spacing-md:16px;
  --spacing-lg:20px;
  --safe-bottom:env(safe-area-inset-bottom, 0px);
  --safe-top:env(safe-area-inset-top, 0px);
  --container-max:960px;
}

* {
  box-sizing:border-box;
}

html {
  height:100%;
  font-size:var(--font-base);
  -webkit-text-size-adjust:100%;
}

body {
  margin:0;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Helvetica,Arial,sans-serif;
  line-height:var(--line-height);
  padding:var(--safe-top) env(safe-area-inset-right, 12px) calc(var(--safe-bottom) + var(--spacing-lg)) env(safe-area-inset-left, 12px);
  -webkit-tap-highlight-color:transparent;
}

img,
svg {
  max-width:100%;
  height:auto;
}

main,
.app-header,
.app-footer {
  width:min(var(--container-max), 100%);
  margin:0 auto;
}

.app-header {
  position:sticky;
  top:0;
  z-index:10;
  background:rgba(21,21,21,0.88);
  backdrop-filter:blur(14px);
  border-bottom:1px solid var(--border);
  padding:calc(var(--spacing-md) + var(--safe-top)) var(--spacing-md) var(--spacing-sm);
}

.app-header h1 {
  margin:0 0 var(--spacing-xs);
  font-size:1.25rem;
  letter-spacing:0.4px;
}

.muted {
  color:var(--muted);
}

.day-controls {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-sm);
  align-items:center;
  justify-content:center;
  margin-bottom:var(--spacing-sm);
}

.day-controls input[type="date"],
.day-controls button {
  flex:1 1 160px;
  min-height:44px;
}

.tabs {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-sm);
}

.tab {
  flex:1 1 calc(50% - var(--spacing-sm));
  min-height:44px;
  padding:var(--spacing-sm);
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--muted);
  font-weight:600;
  text-align:center;
  transition:background 120ms ease, transform 120ms ease, box-shadow 120ms ease;
}

.tab.active,
.tab:focus-visible {
  color:var(--text);
  border-color:var(--accent);
  box-shadow:0 0 0 1px rgba(76,201,240,0.4);
  outline:none;
}

.tab:active,
.tab.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

main {
  flex:1 1 auto;
  padding:var(--spacing-lg) var(--spacing-md);
  display:flex;
  flex-direction:column;
  gap:var(--spacing-lg);
}

.tab-panel.hidden {
  display:none;
}

.table-scroll {
  overflow:auto;
  border-radius:var(--radius-md);
  background:var(--panel);
  border:1px solid var(--border);
}

.data-table {
  width:100%;
  border-collapse:collapse;
  font-size:0.9rem;
}

.data-table thead {
  background:var(--elev);
}

.data-table th,
.data-table td {
  padding:var(--spacing-sm);
  text-align:left;
  border-bottom:1px solid var(--border);
  white-space:nowrap;
}

.data-table td[data-align="right"],
.data-table .actions-header {
  text-align:right;
}

.data-table tbody tr:nth-child(odd) {
  background:rgba(33,33,33,0.8);
}

.badge,
.summary-badge,
.history-chip,
.tag-chip,
.habit-chip {
  display:inline-flex;
  align-items:center;
  gap:6px;
  border-radius:999px;
  padding:4px 12px;
  font-size:0.8rem;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--muted);
  min-height:32px;
}

.habit-chip input {
  accent-color:var(--accent);
}

.hidden {
  display:none !important;
}

.sr-only {
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}

.alert {
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:var(--spacing-md);
  margin:var(--spacing-sm) 0;
  font-size:0.9rem;
}

.seguimiento-header {
  display:flex;
  justify-content:flex-end;
  margin-bottom:var(--spacing-md);
  position:sticky;
  top:calc(var(--spacing-lg) + var(--safe-top) + 48px);
  z-index:9;
  padding:var(--spacing-sm) 0;
  background:rgba(10,10,10,0.92);
  backdrop-filter:blur(10px);
}

.seguimiento-layout {
  display:flex;
  flex-direction:column;
  gap:var(--spacing-md);
}

.seguimiento-panel {
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  padding:var(--spacing-lg);
  box-shadow:var(--shadow-soft);
  min-height:320px;
}

.seguimiento-panel .empty-hint {
  margin:0;
  text-align:center;
  color:var(--muted);
  font-size:0.9rem;
}

.history-list {
  list-style:none;
  margin:0;
  padding:0;
  display:flex;
  flex-direction:column;
  gap:var(--spacing-sm);
  max-height:520px;
  overflow:auto;
}

.history-item-button {
  width:100%;
  text-align:left;
  background:var(--panel);
  border:1px solid var(--border);
  color:var(--text);
  border-radius:var(--radius-md);
  padding:var(--spacing-md);
  font-weight:600;
  min-height:52px;
  transition:transform 120ms ease, box-shadow 120ms ease;
}

.history-item-button.active,
.history-item-button:focus-visible {
  border-color:var(--accent);
  box-shadow:0 0 0 1px rgba(76,201,240,0.4);
  outline:none;
}

.history-item-button:active,
.history-item-button.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

.history-item {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.history-item-chips {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-xs);
}

.history-chip.active {
  color:var(--accent);
  border-color:var(--accent);
  background:rgba(76,201,240,0.18);
}

.history-detail {
  display:flex;
  flex-direction:column;
  gap:18px;
}

.history-detail-header {
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
  gap:var(--spacing-sm);
}

.history-detail-header h2 {
  margin:0;
  font-size:1.2rem;
  display:flex;
  align-items:center;
  gap:10px;
}

.type-selector {
  display:flex;
  gap:var(--spacing-sm);
  flex-wrap:wrap;
}

.type-selector-btn {
  background:var(--panel);
  border:1px solid var(--border);
  color:var(--text);
  border-radius:999px;
  padding:var(--spacing-sm) var(--spacing-md);
  font-weight:600;
  min-height:44px;
}

.type-selector-btn.active,
.type-selector-btn:focus-visible {
  border-color:var(--accent);
  color:var(--accent);
  box-shadow:0 0 0 1px rgba(76,201,240,0.35);
  outline:none;
}

.type-selector-btn:active,
.type-selector-btn.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

.history-controls {
  display:flex;
  align-items:center;
  gap:var(--spacing-sm);
  flex-wrap:wrap;
  font-size:0.9rem;
}

.history-controls select {
  min-height:44px;
}

.history-summary {
  display:flex;
  flex-direction:column;
  gap:var(--spacing-sm);
}

.summary-badge.up {
  color:var(--success);
  border-color:var(--success);
}

.summary-badge.down {
  color:var(--error);
  border-color:var(--error);
}

.summary-grid {
  display:grid;
  gap:var(--spacing-sm);
  grid-template-columns:repeat(auto-fit, minmax(160px,1fr));
}

.summary-grid dt {
  font-size:0.85rem;
  color:var(--muted);
  margin-bottom:4px;
}

.summary-grid dd {
  margin:0;
  font-weight:600;
}

.history-chart-wrapper {
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  background:var(--panel);
  padding:var(--spacing-md);
}

.link-button {
  background:none;
  border:none;
  color:var(--accent);
  padding:0 var(--spacing-xs);
  font-size:0.85rem;
}

.link-button.danger {
  color:#f86d6d;
}

.toast {
  position:fixed;
  left:50%;
  bottom:calc(var(--safe-bottom) + 20px);
  transform:translateX(-50%);
  background:var(--elev);
  color:var(--text);
  padding:var(--spacing-sm) var(--spacing-lg);
  border-radius:999px;
  border:1px solid var(--border);
  box-shadow:var(--shadow-strong);
  opacity:0;
  pointer-events:none;
  transition:opacity 200ms ease, transform 200ms ease;
  z-index:20;
}

.toast.visible {
  opacity:1;
  transform:translateX(-50%) translateY(-6px);
}

.card {
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  padding:var(--spacing-lg);
  box-shadow:var(--shadow-soft);
}

.grid {
  display:grid;
  gap:var(--spacing-sm);
}

.field {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.field.inline {
  width:100%;
}

.field span,
.field-header span,
.summary-grid dt,
.history-controls,
.future-item-meta {
  color:var(--muted);
}

.field input,
.field select,
.field textarea,
.day-controls input[type="date"],
.day-controls button,
.history-controls select,
.history-item-button,
.type-selector-btn,
.library-select-card,
button,
input,
select,
textarea {
  font-family:inherit;
}

.field input,
.field select,
.field textarea,
.day-controls input[type="date"],
.history-controls select,
.library-select-card,
.future-form .field input,
.future-form .field select,
.future-form .field textarea {
  background:var(--elev);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  padding:12px;
  min-height:44px;
}

.field textarea,
.future-form .field textarea,
.exercise .note-box textarea {
  resize:vertical;
  font-size:1rem;
  line-height:var(--line-height);
  min-height:120px;
}

::placeholder {
  color:var(--muted);
  opacity:0.8;
}

input:focus-visible,
select:focus-visible,
textarea:focus-visible,
.library-select-card:focus-visible,
.day-controls input[type="date"]:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}

.form-stepper,
.type-selector,
.future-form,
.future-list,
.exercise .controls,
.today-habits,
.history-item-chips {
  gap:var(--spacing-sm);
}

.form-stepper,
.form-steps,
.future-section,
.future-list,
.exercise-list,
.library-card-body,
.history-detail,
.history-summary,
.today-cta {
  display:flex;
  flex-direction:column;
}

.form-step-btn {
  flex:1 1 auto;
  padding:var(--spacing-sm) var(--spacing-md);
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--muted);
  font-weight:600;
  text-transform:uppercase;
  font-size:0.78rem;
  letter-spacing:0.4px;
  min-height:44px;
}

.form-step-btn.active,
.form-step-btn:focus-visible {
  color:var(--text);
  border-color:var(--accent);
  box-shadow:0 0 0 1px rgba(76,201,240,0.3);
  outline:none;
}

.form-step-btn:active,
.form-step-btn.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

.form-step {
  display:none;
}

.form-step.active {
  display:block;
}

.chip,
.habit-chip,
.tag-chip {
  transition:border-color 120ms ease, color 120ms ease;
}

.chip:active,
.chip.is-pressed,
.habit-chip:active,
.habit-chip.is-pressed,
.tag-chip:active,
.tag-chip.is-pressed {
  border-color:var(--accent);
  color:var(--accent);
  background:rgba(76,201,240,0.2);
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

.form-hint {
  margin-top:var(--spacing-sm);
  padding:var(--spacing-md);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  background:var(--panel);
  color:var(--muted);
  font-size:0.88rem;
}

.step-actions,
.actions,
.future-item-actions,
.library-card-actions,
.exercise .note-actions,
.modal-actions {
  display:flex;
  gap:var(--spacing-sm);
  flex-wrap:wrap;
  justify-content:flex-end;
}

.future-section {
  gap:var(--spacing-lg);
  margin-top:var(--spacing-lg);
}

.future-intro {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-md);
  align-items:flex-start;
  justify-content:space-between;
}

.future-copy h2 {
  margin:0;
  font-size:1.1rem;
}

.future-copy p {
  margin:6px 0 0;
  max-width:360px;
}

.future-form {
  align-items:flex-end;
  flex-wrap:wrap;
}

.future-form .field {
  flex:1 1 240px;
  min-width:200px;
}

.future-item {
  display:flex;
  align-items:center;
  gap:var(--spacing-md);
  justify-content:space-between;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:var(--spacing-md);
}

.future-item-text {
  flex:1;
  font-weight:600;
}

.fieldset {
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:var(--spacing-md);
  background:var(--panel);
}

.fieldset .legend {
  display:block;
  color:var(--muted);
  margin-bottom:6px;
  font-size:0.9rem;
}

.row {
  display:flex;
  align-items:center;
  gap:var(--spacing-sm);
  flex-wrap:wrap;
}

.row.indent {
  margin-left:24px;
  margin-top:var(--spacing-xs);
}

.app-footer {
  padding:var(--spacing-md);
  text-align:center;
  color:var(--muted);
  position:sticky;
  bottom:0;
  background:rgba(10,10,10,0.94);
  backdrop-filter:blur(12px);
  border-top:1px solid var(--border);
  padding-bottom:calc(var(--spacing-md) + var(--safe-bottom));
}

button,
.day-controls button,
.history-controls select,
.type-selector-btn,
.library-select-card,
.future-form button,
.exercise .controls button,
.modal-actions button {
  cursor:pointer;
  transition:transform 120ms ease, box-shadow 120ms ease, filter 120ms ease;
}

button,
.day-controls button,
.future-form button,
.modal-actions button,
.exercise .controls button {
  min-height:48px;
  border-radius:var(--radius-md);
  padding:12px var(--spacing-md);
  font-weight:600;
  border:none;
  background:var(--accent);
  color:#050505;
  box-shadow:0 6px 20px rgba(76,201,240,0.35);
}

button.secondary,
.day-controls button,
.future-form button.secondary,
.modal-actions button.secondary,
.exercise .controls button.secondary,
button.ghost,
button.link,
button.micro,
button.small,
button.tiny {
  background:transparent;
  color:var(--text);
  border:1px solid var(--border);
  box-shadow:none;
}

button.danger {
  background:var(--error);
  color:#1d0000;
}

button.success {
  background:var(--success);
  color:#01210f;
}

button:active,
button.is-pressed,
.day-controls button:active,
.future-form button:active,
.modal-actions button:active,
.exercise .controls button:active {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
  filter:brightness(1.06);
}

button:focus-visible,
.day-controls button:focus-visible,
.future-form button:focus-visible,
.exercise .controls button:focus-visible,
.modal-actions button:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}

button.small {
  padding:8px 12px;
  min-height:44px;
  font-size:0.85rem;
  border-radius:var(--radius-sm);
}

button.tiny,
button.micro {
  padding:6px 10px;
  min-height:40px;
  font-size:0.78rem;
  border-radius:999px;
}

button.link {
  padding:0;
  min-height:auto;
}

button.link:active,
button.link.is-pressed {
  filter:none;
  transform:none;
}

button.danger:active,
button.success:active {
  filter:brightness(1.08);
}

.today-panel {
  display:flex;
  flex-direction:column;
  gap:var(--spacing-lg);
}

.today-overview,
.today-badges,
.summary-grid,
.history-trends,
.library-grid,
.library-filters {
  display:grid;
  gap:var(--spacing-sm);
}

.today-overview {
  grid-template-columns:repeat(auto-fit, minmax(180px,1fr));
}

.insight-card,
.trend-card,
.today-badge,
.future-item,
.library-card,
.library-mini,
.library-select-card,
.exercise,
.modal .modal-content,
.history-chart-wrapper,
.today-panel .card,
.insight-card,
.today-badge {
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
}

.insight-card,
.trend-card,
.today-badge,
.exercise,
.library-card {
  padding:var(--spacing-md);
  box-shadow:var(--shadow-soft);
}

.insight-card header,
.trend-card h4,
.today-habits h3,
.future-copy h2,
.history-detail-header h2,
.library-card-title h3,
.modal-header h2 {
  color:var(--text);
}

.insight-card small,
.today-badge small,
.library-card-category,
.library-card-notes,
.library-mini,
.future-item-meta {
  color:var(--muted);
}

.rpe-control input[type="range"] {
  accent-color:var(--accent);
}

.exercise {
  position:relative;
  display:flex;
  flex-direction:column;
  gap:var(--spacing-sm);
  padding:var(--spacing-lg);
  background:var(--panel);
  box-shadow:var(--shadow-soft);
}

.exercise .title {
  display:flex;
  flex-direction:column;
  gap:var(--spacing-sm);
}

.exercise .meta {
  color:var(--muted);
  font-size:0.9rem;
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-xs);
}

.exercise .meta span {
  background:var(--elev);
  padding:2px 8px;
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
}

.exercise.completed {
  border-color:rgba(34,197,94,0.65);
  box-shadow:0 0 0 1px rgba(34,197,94,0.3);
}

.exercise.not-done {
  border-color:rgba(239,68,68,0.65);
  box-shadow:0 0 0 1px rgba(239,68,68,0.3);
}

.exercise .note-toggle.is-pressed,
.exercise .note-toggle:active {
  border-color:var(--accent);
  color:var(--accent);
  background:rgba(76,201,240,0.18);
}

.exercise .note-box,
.exercise .edit-box {
  border-top:1px dashed var(--border);
  padding-top:var(--spacing-sm);
  display:flex;
  flex-direction:column;
  gap:var(--spacing-sm);
}

.exercise .sets-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(88px,1fr));
  gap:var(--spacing-sm);
}

.exercise .sets-grid input {
  width:100%;
}

.drag-handle {
  border:1px solid var(--border);
  background:var(--elev);
  color:var(--text);
  border-radius:var(--radius-sm);
  padding:var(--spacing-xs);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:grab;
  touch-action:none;
  min-width:44px;
  min-height:44px;
  font-size:1.2rem;
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.05);
}

.drag-handle span {
  pointer-events:none;
}

.drag-handle:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}

.exercise.dragging {
  opacity:0.95;
  box-shadow:var(--shadow-strong);
  cursor:grabbing;
}

.exercise.dragging .drag-handle {
  cursor:grabbing;
}

.exercise-placeholder {
  border:2px dashed var(--border);
  border-radius:var(--radius-md);
  background:var(--panel);
}

.category-tag {
  position:absolute;
  top:0;
  left:24px;
  transform:translateY(-50%);
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 14px;
  border-radius:999px;
  font-weight:600;
  letter-spacing:0.3px;
  text-transform:uppercase;
  font-size:0.7rem;
  border:1px solid var(--border);
  background:var(--elev);
  box-shadow:var(--shadow-soft);
  white-space:nowrap;
}

.category-tag::before {
  content:"";
  width:8px;
  height:8px;
  border-radius:50%;
  background:currentColor;
  box-shadow:0 0 0 2px rgba(255,255,255,0.08);
}

.category-tag-calistenia {
  color:var(--success);
}

.category-tag-musculacion {
  color:var(--accent);
}

.category-tag-cardio {
  color:var(--accent-2);
}

.category-tag-skill {
  color:#f38abf;
}

.category-tag-piernas {
  color:#f6b661;
}

.category-tag-movilidad {
  color:#5bdad0;
}

.category-tag-otro {
  color:var(--muted);
}

.empty-hint {
  opacity:0.85;
  text-align:center;
  color:var(--muted);
  border:1px dashed var(--border);
  border-radius:var(--radius-md);
  padding:var(--spacing-lg);
  margin-top:var(--spacing-sm);
}

.mini-cal {
  position:fixed;
  right:12px;
  bottom:calc(var(--safe-bottom) + 12px);
  z-index:5;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  box-shadow:var(--shadow-soft);
  width:280px;
  max-width:90vw;
  padding:var(--spacing-md);
}

.mini-cal-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:var(--spacing-xs);
}

.mini-cal-grid {
  display:grid;
  grid-template-columns:repeat(7, 1fr);
  gap:var(--spacing-xs);
  align-items:center;
}

.mini-cal-grid .dow {
  text-align:center;
  color:var(--muted);
  font-size:0.75rem;
}

.mini-cal-grid button.day {
  aspect-ratio:1/1;
  background:var(--elev);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  font-weight:600;
  min-height:44px;
}

.mini-cal-grid button.day.today {
  outline:2px solid var(--accent);
}

.mini-cal-grid button.day.has {
  box-shadow:inset 0 0 0 2px rgba(76,201,240,0.3);
}

.mini-cal-grid button.day.selected {
  background:var(--accent);
  color:#050505;
}

.library-header {
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:var(--spacing-md);
  flex-wrap:wrap;
  margin-bottom:var(--spacing-lg);
}

.library-grid {
  grid-template-columns:repeat(auto-fit, minmax(240px,1fr));
}

.library-grid.compact {
  grid-template-columns:repeat(auto-fit, minmax(200px,1fr));
}

.library-card {
  display:flex;
  flex-direction:column;
  gap:var(--spacing-md);
}

.library-card-header {
  display:flex;
  gap:var(--spacing-md);
  align-items:center;
}

.library-card-title {
  display:flex;
  flex-direction:column;
  gap:4px;
}

.library-card-body {
  gap:var(--spacing-sm);
}

.library-card-tags {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-xs);
}

.library-mini {
  display:flex;
  align-items:center;
  gap:var(--spacing-sm);
  margin-top:var(--spacing-sm);
  padding:var(--spacing-sm);
  font-size:0.85rem;
}

.library-mini.hidden {
  display:none !important;
}

.library-selector-filters {
  display:flex;
  flex-wrap:wrap;
  gap:var(--spacing-sm);
  margin-bottom:var(--spacing-md);
}

.library-select-card {
  display:flex;
  align-items:center;
  gap:var(--spacing-md);
  width:100%;
  background:var(--panel);
  color:var(--text);
  font-weight:600;
  text-align:left;
  min-height:52px;
  transition:transform 120ms ease, box-shadow 120ms ease;
}

.library-select-card:active,
.library-select-card.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

.miniature {
  width:var(--miniature-size, 40px);
  height:var(--miniature-size, 40px);
  border-radius:12px;
  background:var(--elev);
  display:flex;
  align-items:center;
  justify-content:center;
  color:var(--text);
  font-size:calc(var(--miniature-size, 40px) * 0.6);
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.05);
  overflow:hidden;
}

.miniature img {
  width:100%;
  height:100%;
  object-fit:cover;
}

.image-preview {
  display:flex;
  align-items:center;
  gap:var(--spacing-md);
}

.image-preview img {
  width:56px;
  height:56px;
  object-fit:cover;
  border-radius:12px;
  border:1px solid var(--border);
}

.modal {
  position:fixed;
  inset:0;
  background:rgba(10,10,10,0.82);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:var(--spacing-lg);
  z-index:40;
}

.modal.hidden {
  display:none !important;
}

.modal .modal-content {
  width:min(520px, 100%);
  max-height:100dvh;
  overflow:auto;
  display:flex;
  flex-direction:column;
  box-shadow:var(--shadow-strong);
}

.modal-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:var(--spacing-md);
  padding:var(--spacing-lg);
  border-bottom:1px solid var(--border);
}

.modal-body {
  padding:var(--spacing-lg);
  display:flex;
  flex-direction:column;
  gap:var(--spacing-md);
}

.modal-body .fieldset {
  background:var(--panel);
}

body.modal-open {
  overflow:hidden;
}

.mini-cal-grid button.day:focus-visible,
.library-select-card:focus-visible,
.history-item-button:focus-visible,
.type-selector-btn:focus-visible,
.form-step-btn:focus-visible,
.tab:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}

.mini-cal-grid button.day:active,
.mini-cal-grid button.day.is-pressed {
  transform:scale(0.98);
  box-shadow:var(--shadow-pressed);
}

@media (max-width:880px) {
  .seguimiento-layout {
    gap:var(--spacing-lg);
  }
}

@media (max-width:640px) {
  main,
  .app-header,
  .app-footer {
    width:100%;
  }

  .tabs {
    width:100%;
  }

  .copy-day {
    width:100%;
    display:flex;
    flex-wrap:wrap;
    gap:var(--spacing-sm);
  }

  .exercise .title-main,
  .exercise .controls {
    width:100%;
  }

  .mini-cal {
    display:none;
  }
}

@media (prefers-reduced-motion:reduce) {
  *,
  *::before,
  *::after {
    animation-duration:0.01ms !important;
    animation-iteration-count:1 !important;
    transition-duration:0.01ms !important;
    scroll-behavior:auto !important;
  }
}
